Запрос 1

SELECT theme
FROM lessons_marks
JOIN lessons ON lessons.id = id_lesson
WHERE id_user = "ид юзвера"
ORDER BY mark, making_time DESC
LIMIT 5;
МБ добавить время за которое анализируем

SELECT DISTINCT id_lesson
FROM lessons_marks
WHERE id_user = "ид юзвера";

SELECT complexity, id, label, theme
FROM lessons
WHERE theme IN (темы найденые ранее)
AND id NOT IN (ид из прошлого запроса)
ORDER BY complexity
LIMIT 5;



Запрос 2

SELECT id_lesson
FROM lessons_marks
WHERE date < дата 1 AND date > дата 2
GROUP BY id_lesson
ORDER BY count(id) DESC
LIMIT 5;

SELECT theme
FROM lessons
WHERE id IN (ид из прошлого запроса)
GROUP BY theme
ORDER BY count(theme) DESC;



Запрос 3

SELECT level, making_time, mark, date
FROM lessons_marks
JOIN users ON users.id = id_user
WHERE id_lesson = "ид урока для которого нужна статистика"
ORDER BY level DESC, making_time, date DESC;